"use strict";(self.webpackChunkmy_ts_app=self.webpackChunkmy_ts_app||[]).push([[393,565],{1565:(e,a,t)=>{t.r(a),t.d(a,{MainWrapper:()=>f,default:()=>m});var l=t(2791),r=t(3614),s=t(9633),n=t(6934),o=t(6029),i=t(4045),d=t(4420),c=t(2643),h=t(3763),u=t(184);s.O3h.registerModules([s.wUi,s.yir,s.imY,s.ICW]);const f=(0,n.ZP)(o.Z)((()=>({width:"100%",marginLeft:"170px",height:"93%",marginTop:"60px",padding:"16px",background:"#d0d0d0"}))),m=()=>{var e,a;const t=(0,d.I0)(),[n]=(0,l.useState)(0),[o,m]=(0,l.useState)(null),{calendarData:p,fileAdded:v}=(0,d.v9)((e=>e.fileData));(0,l.useEffect)((()=>{o&&g({api:o})}),[v,o]);const g=async e=>{m(e.api);try{const e=localStorage.getItem("file");let a;if(e){const t=JSON.parse(e),l=atob(t.split(",")[1]),r=new Array(l.length);for(let e=0;e<l.length;e++)r[e]=l.charCodeAt(e);const s=new Uint8Array(r);a=new Blob([s],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})}else{const e=await fetch(h.Ye);a=await e.blob()}if(!a)return;const l=new FileReader;l.readAsArrayBuffer(a),l.onload=e=>{var a;const l=null===(a=e.target)||void 0===a?void 0:a.result,r=i.ij(new Uint8Array(l),{type:"array"}),s=r.Sheets.Calendar,n=i.P6.sheet_to_json(s),o=r.Sheets.Planning,d=i.P6.sheet_to_json(o),h=r.Sheets.SKUs,u=i.P6.sheet_to_json(h),f={};u.forEach((e=>{let{ID:a,Label:t,Price:l,Cost:r}=e;f[a]={price:parseFloat(l),Label:t,cost:parseFloat(r)}}));const m=r.Sheets.Stores,p=i.P6.sheet_to_json(m),v={};p.forEach((e=>{let{ID:a,Label:t}=e;v[a]=t}));const g=[],b=[],S={};n.forEach((e=>{const{"Month Label":a,"Week Label":t,Week:l}=e;g.includes(a)||g.push(a),b.includes(l)||b.push(l),S[a]||(S[a]={headerName:a,children:[]});let r=S[a].children.find((e=>e.week===l));r||(r={headerName:t,week:l,children:[]},S[a].children.push(r))})),d.forEach((e=>{let{Store:a,SKU:t,Week:l,"Sales Units":r}=e;const s=f[t].price||0,n=f[t].cost||0,o=f[t].Label,i=v[a],d=s*r,c=d-r*n,h=Math.trunc(c/d*100)||0;Object.values(S).forEach((e=>{const s=e.children.find((e=>e.week===l));s&&s.children.push({Store:a,SKU:t,SalesUnits:r,SalesDollar:d.toFixed(2),skuLabel:o,storeLabel:i,gmDollar:c.toFixed(2),gmPercent:h})}))}));const w=g.map((e=>S[e])).filter(Boolean).map((e=>({...e,children:e.children.sort(((e,a)=>b.indexOf(e.week)-b.indexOf(a.week)))})));t((0,c.k2)(w))}}catch(a){console.error("Error fetching data:",a)}},[b,S]=(0,l.useState)((null===(e=p[n])||void 0===e||null===(a=e.children)||void 0===a?void 0:a.map((e=>[...e.children])).flat())||[]);(0,l.useEffect)((()=>{var e,a;S((null===(e=p[n])||void 0===e||null===(a=e.children)||void 0===a?void 0:a.map((e=>[...e.children])).flat())||[])}),[p]);const w=[{headerName:"Store",field:"storeLabel",pinned:"left",width:250},{headerName:"SKU",field:"skuLabel",pinned:"left",width:250},...(null!==p&&void 0!==p?p:[]).map((e=>{var a;return{headerName:e.headerName,children:(null!==(a=e.children)&&void 0!==a?a:[]).map((e=>({headerName:e.headerName,children:[{headerName:"Sales Units",field:"SalesUnits",cellStyle:h.hD,width:130},{headerName:"Sales Dollars",field:"SalesDollar",valueFormatter:e=>"$".concat(e.value),cellStyle:h.hD,width:130},{headerName:"GM Dollars",field:"gmDollar",valueFormatter:e=>"$".concat(e.value),cellStyle:h.hD,width:130},{headerName:"GM Percent",field:"gmPercent",valueFormatter:e=>"".concat(e.value,"%"),cellStyle:h.hD,cellClassRules:h.e_,width:130}]})))}}))];return(0,u.jsx)(f,{children:(0,u.jsx)(r.s,{rowData:b,columnDefs:w,modules:[s.ICW],debug:!0,defaultColDef:h.KR,onGridReady:g})})}},1393:(e,a,t)=>{t.r(a),t.d(a,{default:()=>N});var l=t(2791),r=t(3614),s=t(9633),n=t(1565),o=t(4045),i=t(3400),d=t(6029),c=t(4294),h=t(4420),u=t(2643),f=(t(6704),t(1668)),m=t(3763),p=t(5289),v=t(7123),g=t(9157),b=t(5661),S=t(7665),w=t(184);function x(){const e=(0,h.I0)(),{addSkuDialog:a,skuData:t}=(0,h.v9)((e=>e.fileData)),[r,s]=(0,l.useState)(""),[n,o]=(0,l.useState)(""),[i,d]=(0,l.useState)(""),[f,m]=(0,l.useState)(""),[x,D]=(0,l.useState)(""),N=()=>{e((0,u.v9)(!1)),s(""),o(""),d(""),m(""),D("")};return(0,w.jsxs)(p.Z,{open:a,onClose:N,children:[(0,w.jsx)(b.Z,{children:"Add New SKU"}),(0,w.jsxs)(g.Z,{children:[(0,w.jsx)(S.Z,{label:"SKU",fullWidth:!0,margin:"dense",value:r,onChange:e=>s(e.target.value)}),(0,w.jsx)(S.Z,{label:"Price ($)",fullWidth:!0,margin:"dense",value:n,onChange:e=>o(e.target.value),error:isNaN(Number(n)),helperText:isNaN(Number(n))?"Enter a valid price":""}),(0,w.jsx)(S.Z,{label:"Cost ($)",fullWidth:!0,margin:"dense",value:i,onChange:e=>d(e.target.value),error:isNaN(Number(i)),helperText:isNaN(Number(i))?"Enter a valid cost":""}),(0,w.jsx)(S.Z,{label:"ID",fullWidth:!0,margin:"dense",value:f,onChange:e=>m(e.target.value),error:!!x,helperText:x})]}),(0,w.jsxs)(v.Z,{children:[(0,w.jsx)(c.Z,{onClick:N,sx:{background:"red",color:"#ffff","&:hover":{background:"red",opacity:.7}},children:"Cancel"}),(0,w.jsx)(c.Z,{onClick:()=>{r&&n&&i&&f?(e=>t.some((a=>a.ID===e)))(f)?D("ID already exists. Please use a unique ID."):isNaN(Number(n))||isNaN(Number(i))?D("Price and Cost must be valid numbers."):(e((0,u.JY)([...t,{ID:f,name:r,price:parseFloat(n),cost:parseFloat(i)}])),N()):D("All fields are required.")},sx:{background:"gray",color:"#ffff","&:hover":{background:"gray",opacity:.7}},disabled:!r||!n||!i||!f,children:"Add"})]})]})}s.O3h.registerModules([s.I6w,s.oUh,s.CBb,s.ICW,s.n4K,s.wUi,s.yir,s.ZAx]);const D=e=>{const{skuData:a}=(0,h.v9)((e=>e.fileData)),t=(0,h.I0)();return(0,w.jsx)(i.Z,{onClick:()=>{const l=a.filter((a=>a.ID!==e.data.ID)).map(((e,a)=>({...e,seqNo:a+1})));t((0,u.JY)(l))},size:"small",children:(0,w.jsx)(f.Z,{})})},N=()=>{const e=(0,h.I0)(),[a,t]=(0,l.useState)(null),{skuData:s,fileAdded:i}=(0,h.v9)((e=>e.fileData)),f=(0,l.useMemo)((()=>({width:"100%",height:"100%"})),[]),p=(0,l.useMemo)((()=>({height:"100%",width:"100%"})),[]),[v]=(0,l.useState)([{headerName:"",field:"delete",width:50,cellRenderer:D},{headerName:"SKU",field:"name",width:300,editable:!0},{headerName:"Price",field:"price",width:150,editable:!0},{headerName:"Cost",field:"cost",width:150,editable:!0}]),g={width:170,valueSetter:a=>{const t=a.data.ID,l=a.column.colId;if(null!==a&&void 0!==a&&a.newValue){const r=null===s||void 0===s?void 0:s.map((e=>e.ID===t?{...e,[l]:a.newValue}:e));e((0,u.JY)(r))}}};(0,l.useEffect)((()=>{a&&b({api:a})}),[i,a]);const b=(0,l.useCallback)((async a=>{t(a.api);const l=localStorage.getItem("file");let r;if(l){const e=JSON.parse(l),a=atob(e.split(",")[1]),t=new Array(a.length);for(let l=0;l<a.length;l++)t[l]=a.charCodeAt(l);const s=new Uint8Array(t);r=new Blob([s],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})}else{const e=await fetch(m.Ye);r=await e.blob()}if(!r)return;const s=new FileReader;s.onload=a=>{var t;const l=null===(t=a.target)||void 0===t?void 0:t.result,r=o.ij(l,{type:"binary"}).Sheets.SKUs,s=o.P6.sheet_to_json(r).map((e=>({ID:e.ID,name:e.Label,price:e.Price,cost:e.Cost.toFixed(2)})));e((0,u.JY)(s))},s.readAsArrayBuffer(r)}),[]),S=(0,l.useCallback)((()=>{var t;if(!a)return;const l=null===a||void 0===a||null===(t=a.getRenderedNodes())||void 0===t?void 0:t.map(((e,a)=>({...e.data,seqNo:a+1})));e((0,u.JY)(l))}),[a,e]);return(0,w.jsxs)(n.MainWrapper,{sx:{height:"85%"},children:[(0,w.jsx)(d.Z,{style:f,children:(0,w.jsx)(d.Z,{style:p,children:(0,w.jsx)(r.s,{rowData:s,columnDefs:v,defaultColDef:g,rowDragManaged:!0,onGridReady:b,onDragStopped:S})})}),(0,w.jsx)(c.Z,{onClick:()=>e((0,u.v9)(!0)),sx:{mt:2,background:"gray",color:"#ffff",px:2,"&:hover":{background:"gray",opacity:.7}},children:"Add SKU"}),(0,w.jsx)(x,{})]})}},6704:()=>{}}]);
//# sourceMappingURL=393.6317b346.chunk.js.map