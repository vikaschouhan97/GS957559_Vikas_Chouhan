"use strict";(self.webpackChunkmy_ts_app=self.webpackChunkmy_ts_app||[]).push([[565],{1565:(e,l,a)=>{a.r(l),a.d(l,{MainWrapper:()=>f,default:()=>m});var t=a(2791),r=a(3614),s=a(9633),d=a(6934),n=a(6029),i=a(4045),o=a(4420),c=a(2643),h=a(3763),u=a(184);s.O3h.registerModules([s.wUi,s.yir,s.imY,s.ICW]);const f=(0,d.ZP)(n.Z)((()=>({width:"100%",marginLeft:"170px",height:"93%",marginTop:"60px",padding:"16px",background:"#d0d0d0"}))),m=()=>{var e,l,a,d,n;const m=(0,o.I0)(),[p]=(0,t.useState)(0),{calendarData:v}=(0,o.v9)((e=>e.fileData)),[S,w]=(0,t.useState)((null===(e=v[p])||void 0===e||null===(l=e.children)||void 0===l?void 0:l.map((e=>[...e.children])).flat())||[]);(0,t.useEffect)((()=>{var e,l;w((null===(e=v[p])||void 0===e||null===(l=e.children)||void 0===l?void 0:l.map((e=>[...e.children])).flat())||[])}),[v]);const b=[{headerName:"Store",field:"storeLabel",pinned:"left",width:250},{headerName:"SKU",field:"skuLabel",pinned:"left",width:250},{headerName:null===(a=v[p])||void 0===a?void 0:a.headerName,children:null===(d=v[p])||void 0===d||null===(n=d.children)||void 0===n?void 0:n.map((e=>({headerName:e.headerName,children:[{headerName:"Sales Units",field:"SalesUnits",cellStyle:h.hD,width:130},{headerName:"Sales Dollars",field:"SalesDollar",valueFormatter:e=>"$".concat(e.value),cellStyle:h.hD,width:130},{headerName:"GM Dollars",field:"gmDollar",valueFormatter:e=>"$".concat(e.value),cellStyle:h.hD,width:130},{headerName:"GM Percent",field:"gmPercent",valueFormatter:e=>"".concat(e.value,"%"),cellStyle:h.hD,cellClassRules:h.e_,width:130}]})))}];return(0,u.jsx)(f,{children:(0,u.jsx)(r.s,{rowData:S,columnDefs:b,modules:[s.ICW],debug:!0,defaultColDef:h.KR,onGridReady:async()=>{const e=await fetch("/assets/file/sampleFile.xlsx"),l=await e.blob();if(!l)return;const a=new FileReader;a.onload=e=>{var l;const a=null===(l=e.target)||void 0===l?void 0:l.result,t=i.ij(a,{type:"binary"}),r=t.Sheets.Calendar,s=i.P6.sheet_to_json(r),d=t.Sheets.Planning,n=i.P6.sheet_to_json(d),o=t.Sheets.SKUs,h=i.P6.sheet_to_json(o),u={};h.forEach((e=>{let{ID:l,Label:a,Price:t,Cost:r}=e;u[l]={price:parseFloat(t),Label:a,cost:parseFloat(r)}}));const f=t.Sheets.Stores,p=i.P6.sheet_to_json(f),v={};p.forEach((e=>{let{ID:l,Label:a}=e;v[l]=a}));const S=[],w=[],b={};s.forEach((e=>{const{"Month Label":l,"Week Label":a,Week:t}=e;S.includes(l)||S.push(l),w.includes(t)||w.push(t),b[l]||(b[l]={headerName:l,children:[]});let r=b[l].children.find((e=>e.week===t));r||(r={headerName:a,week:t,children:[]},b[l].children.push(r))})),n.forEach((e=>{let{Store:l,SKU:a,Week:t,"Sales Units":r}=e;const s=u[a].price||0,d=u[a].cost||0,n=u[a].Label,i=v[l],o=s*r,c=o-r*d,h=Math.trunc(c/o*100)||0;Object.values(b).forEach((e=>{const s=e.children.find((e=>e.week===t));s&&s.children.push({Store:l,SKU:a,SalesUnits:r,SalesDollar:o.toFixed(2),skuLabel:n,storeLabel:i,gmDollar:c.toFixed(2),gmPercent:h})}))}));const D=S.map((e=>b[e])).filter(Boolean).map((e=>({...e,children:e.children.sort(((e,l)=>w.indexOf(e.week)-w.indexOf(l.week)))})));m((0,c.k2)(D))},a.readAsArrayBuffer(l)}})})}}}]);
//# sourceMappingURL=565.94ab947e.chunk.js.map