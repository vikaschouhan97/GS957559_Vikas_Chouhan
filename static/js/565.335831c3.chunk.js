"use strict";(self.webpackChunkmy_ts_app=self.webpackChunkmy_ts_app||[]).push([[565],{1565:(e,a,l)=>{l.r(a),l.d(a,{MainWrapper:()=>f,default:()=>m});var t=l(2791),r=l(3614),n=l(9633),d=l(6934),o=l(6029),i=l(4045),s=l(4420),c=l(2643),h=l(3763),u=l(184);n.O3h.registerModules([n.wUi,n.yir,n.imY,n.ICW]);const f=(0,d.ZP)(o.Z)((()=>({width:"100%",marginLeft:"170px",height:"93%",marginTop:"60px",padding:"16px",background:"#d0d0d0"}))),m=()=>{var e,a,l,d,o;const m=(0,s.I0)(),[p]=(0,t.useState)(0),{calendarData:v}=(0,s.v9)((e=>e.fileData)),[S,w]=(0,t.useState)((null===(e=v[p])||void 0===e||null===(a=e.children)||void 0===a?void 0:a.map((e=>[...e.children])).flat())||[]);(0,t.useEffect)((()=>{var e,a;w((null===(e=v[p])||void 0===e||null===(a=e.children)||void 0===a?void 0:a.map((e=>[...e.children])).flat())||[])}),[v]);const b=[{headerName:"Store",field:"storeLabel",pinned:"left",width:250},{headerName:"SKU",field:"skuLabel",pinned:"left",width:250},{headerName:null===(l=v[p])||void 0===l?void 0:l.headerName,children:null===(d=v[p])||void 0===d||null===(o=d.children)||void 0===o?void 0:o.map((e=>({headerName:e.headerName,children:[{headerName:"Sales Units",field:"SalesUnits",cellStyle:h.hD,width:130},{headerName:"Sales Dollars",field:"SalesDollar",valueFormatter:e=>"$".concat(e.value),cellStyle:h.hD,width:130},{headerName:"GM Dollars",field:"gmDollar",valueFormatter:e=>"$".concat(e.value),cellStyle:h.hD,width:130},{headerName:"GM Percent",field:"gmPercent",valueFormatter:e=>"".concat(e.value,"%"),cellStyle:h.hD,cellClassRules:h.e_,width:130}]})))}];return(0,u.jsx)(f,{children:(0,u.jsx)(r.s,{rowData:S,columnDefs:b,modules:[n.ICW],debug:!0,defaultColDef:h.KR,onGridReady:async()=>{try{const e=await fetch(h.Ye),a=await e.blob();if(!a)return;const l=new FileReader;l.readAsArrayBuffer(a),l.onload=e=>{var a;const l=null===(a=e.target)||void 0===a?void 0:a.result,t=i.ij(new Uint8Array(l),{type:"array"}),r=t.Sheets.Calendar,n=i.P6.sheet_to_json(r),d=t.Sheets.Planning,o=i.P6.sheet_to_json(d),s=t.Sheets.SKUs,h=i.P6.sheet_to_json(s),u={};h.forEach((e=>{let{ID:a,Label:l,Price:t,Cost:r}=e;u[a]={price:parseFloat(t),Label:l,cost:parseFloat(r)}}));const f=t.Sheets.Stores,p=i.P6.sheet_to_json(f),v={};p.forEach((e=>{let{ID:a,Label:l}=e;v[a]=l}));const S=[],w=[],b={};n.forEach((e=>{const{"Month Label":a,"Week Label":l,Week:t}=e;S.includes(a)||S.push(a),w.includes(t)||w.push(t),b[a]||(b[a]={headerName:a,children:[]});let r=b[a].children.find((e=>e.week===t));r||(r={headerName:l,week:t,children:[]},b[a].children.push(r))})),o.forEach((e=>{let{Store:a,SKU:l,Week:t,"Sales Units":r}=e;const n=u[l].price||0,d=u[l].cost||0,o=u[l].Label,i=v[a],s=n*r,c=s-r*d,h=Math.trunc(c/s*100)||0;Object.values(b).forEach((e=>{const n=e.children.find((e=>e.week===t));n&&n.children.push({Store:a,SKU:l,SalesUnits:r,SalesDollar:s.toFixed(2),skuLabel:o,storeLabel:i,gmDollar:c.toFixed(2),gmPercent:h})}))}));const D=S.map((e=>b[e])).filter(Boolean).map((e=>({...e,children:e.children.sort(((e,a)=>w.indexOf(e.week)-w.indexOf(a.week)))})));m((0,c.k2)(D))}}catch(e){console.error("Error fetching data:",e)}}})})}}}]);
//# sourceMappingURL=565.335831c3.chunk.js.map