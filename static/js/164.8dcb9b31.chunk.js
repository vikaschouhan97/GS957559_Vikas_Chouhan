"use strict";(self.webpackChunkmy_ts_app=self.webpackChunkmy_ts_app||[]).push([[164,565],{1565:(e,a,l)=>{l.r(a),l.d(a,{MainWrapper:()=>f,default:()=>m});var t=l(2791),r=l(3614),d=l(9633),i=l(6934),s=l(6029),o=l(4045),n=l(4420),h=l(2643),c=l(3763),u=l(184);d.O3h.registerModules([d.wUi,d.yir,d.imY,d.ICW]);const f=(0,i.ZP)(s.Z)((()=>({width:"100%",marginLeft:"170px",height:"93%",marginTop:"60px",padding:"16px",background:"#d0d0d0"}))),m=()=>{var e,a,l,i,s;const m=(0,n.I0)(),[p]=(0,t.useState)(0),{calendarData:v}=(0,n.v9)((e=>e.fileData)),[S,w]=(0,t.useState)((null===(e=v[p])||void 0===e||null===(a=e.children)||void 0===a?void 0:a.map((e=>[...e.children])).flat())||[]);(0,t.useEffect)((()=>{var e,a;w((null===(e=v[p])||void 0===e||null===(a=e.children)||void 0===a?void 0:a.map((e=>[...e.children])).flat())||[])}),[v]);const D=[{headerName:"Store",field:"storeLabel",pinned:"left",width:250},{headerName:"SKU",field:"skuLabel",pinned:"left",width:250},{headerName:null===(l=v[p])||void 0===l?void 0:l.headerName,children:null===(i=v[p])||void 0===i||null===(s=i.children)||void 0===s?void 0:s.map((e=>({headerName:e.headerName,children:[{headerName:"Sales Units",field:"SalesUnits",cellStyle:c.hD,width:130},{headerName:"Sales Dollars",field:"SalesDollar",valueFormatter:e=>"$".concat(e.value),cellStyle:c.hD,width:130},{headerName:"GM Dollars",field:"gmDollar",valueFormatter:e=>"$".concat(e.value),cellStyle:c.hD,width:130},{headerName:"GM Percent",field:"gmPercent",valueFormatter:e=>"".concat(e.value,"%"),cellStyle:c.hD,cellClassRules:c.e_,width:130}]})))}];return(0,u.jsx)(f,{children:(0,u.jsx)(r.s,{rowData:S,columnDefs:D,modules:[d.ICW],debug:!0,defaultColDef:c.KR,onGridReady:async()=>{const e=await fetch("/assets/file/sampleFile.xlsx"),a=await e.blob();if(!a)return;const l=new FileReader;l.onload=e=>{var a;const l=null===(a=e.target)||void 0===a?void 0:a.result,t=o.ij(l,{type:"binary"}),r=t.Sheets.Calendar,d=o.P6.sheet_to_json(r),i=t.Sheets.Planning,s=o.P6.sheet_to_json(i),n=t.Sheets.SKUs,c=o.P6.sheet_to_json(n),u={};c.forEach((e=>{let{ID:a,Label:l,Price:t,Cost:r}=e;u[a]={price:parseFloat(t),Label:l,cost:parseFloat(r)}}));const f=t.Sheets.Stores,p=o.P6.sheet_to_json(f),v={};p.forEach((e=>{let{ID:a,Label:l}=e;v[a]=l}));const S=[],w=[],D={};d.forEach((e=>{const{"Month Label":a,"Week Label":l,Week:t}=e;S.includes(a)||S.push(a),w.includes(t)||w.push(t),D[a]||(D[a]={headerName:a,children:[]});let r=D[a].children.find((e=>e.week===t));r||(r={headerName:l,week:t,children:[]},D[a].children.push(r))})),s.forEach((e=>{let{Store:a,SKU:l,Week:t,"Sales Units":r}=e;const d=u[l].price||0,i=u[l].cost||0,s=u[l].Label,o=v[a],n=d*r,h=n-r*i,c=Math.trunc(h/n*100)||0;Object.values(D).forEach((e=>{const d=e.children.find((e=>e.week===t));d&&d.children.push({Store:a,SKU:l,SalesUnits:r,SalesDollar:n.toFixed(2),skuLabel:s,storeLabel:o,gmDollar:h.toFixed(2),gmPercent:c})}))}));const b=S.map((e=>D[e])).filter(Boolean).map((e=>({...e,children:e.children.sort(((e,a)=>w.indexOf(e.week)-w.indexOf(a.week)))})));m((0,h.k2)(b))},l.readAsArrayBuffer(a)}})})}},164:(e,a,l)=>{l.r(a),l.d(a,{default:()=>m});var t=l(2791),r=l(3614),d=l(9633),i=l(1565),s=l(4045),o=l(3400),n=l(6029),h=l(1668),c=l(4420),u=l(2643),f=l(184);d.O3h.registerModules([d.I6w,d.oUh,d.CBb,d.ICW,d.n4K,d.ZAx]);const m=()=>{const e=(0,c.I0)(),{storeData:a}=(0,c.v9)((e=>e.fileData)),l=(0,t.useMemo)((()=>({width:"100%",height:"100%"})),[]),d=(0,t.useMemo)((()=>({height:"100%",width:"100%"})),[]),[m]=(0,t.useState)([{headerName:"",field:"delete",width:100,cellRenderer:a=>{const{storeData:l}=(0,c.v9)((e=>e.fileData));return(0,f.jsx)(o.Z,{onClick:()=>{const t=l.filter((e=>e.ID!==a.data.ID)).map(((e,a)=>({...e,seqNo:a+1})));e((0,u.og)(t))},size:"small",color:"error",children:(0,f.jsx)(h.Z,{})})}},{headerName:"S.No.",field:"seqNo",width:100,rowDrag:!0,editable:!0},{headerName:"Store ID",field:"ID",width:150,editable:!0},{headerName:"Store Name",field:"Label",width:250,editable:!0},{headerName:"City",field:"City",width:200,editable:!0},{headerName:"State",field:"State",width:100,editable:!0}]),p=(0,t.useMemo)((()=>({width:170})),[]),v=(0,t.useCallback)((async a=>{w(a.api);const l=await fetch("/assets/file/sampleFile.xlsx"),t=await l.blob();if(!t)return;const r=new FileReader;r.onload=a=>{var l;const t=null===(l=a.target)||void 0===l?void 0:l.result,r=s.ij(t,{type:"binary"}).Sheets.Stores,d=s.P6.sheet_to_json(r).map(((e,a)=>({seqNo:e["Seq No."]||a+1,ID:e.ID,Label:e.Label,City:e.City,State:e.State})));e((0,u.og)(d))},r.readAsArrayBuffer(t)}),[]),[S,w]=(0,t.useState)(null),D=(0,t.useCallback)((()=>{var a;if(!S)return;const l=null===S||void 0===S||null===(a=S.getRenderedNodes())||void 0===a?void 0:a.map(((e,a)=>({...e.data,seqNo:a+1})));e((0,u.og)(l))}),[S,e]);return(0,f.jsx)(i.MainWrapper,{sx:{height:"85%"},children:(0,f.jsx)(n.Z,{style:l,children:(0,f.jsx)(n.Z,{style:d,children:(0,f.jsx)(r.s,{rowData:a,columnDefs:m,defaultColDef:p,rowDragManaged:!0,onGridReady:v,onDragStopped:D})})})})}},1668:(e,a,l)=>{var t=l(4836);a.Z=void 0;var r=t(l(5649)),d=l(184),i=(0,r.default)((0,d.jsx)("path",{d:"M6 21h12V7H6v14zm2.46-9.12 1.41-1.41L12 12.59l2.12-2.12 1.41 1.41L13.41 14l2.12 2.12-1.41 1.41L12 15.41l-2.12 2.12-1.41-1.41L10.59 14l-2.13-2.12zM15.5 4l-1-1h-5l-1 1H5v2h14V4h-3.5z"}),"DeleteForeverSharp");a.Z=i}}]);
//# sourceMappingURL=164.8dcb9b31.chunk.js.map