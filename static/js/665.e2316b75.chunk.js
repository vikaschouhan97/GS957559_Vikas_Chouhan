"use strict";(self.webpackChunkmy_ts_app=self.webpackChunkmy_ts_app||[]).push([[665,164,565],{1565:(e,a,t)=>{t.r(a),t.d(a,{MainWrapper:()=>f,default:()=>m});var l=t(2791),r=t(3614),d=t(9633),i=t(6934),o=t(6029),s=t(4045),n=t(4420),h=t(2643),c=t(3763),u=t(184);d.O3h.registerModules([d.wUi,d.yir,d.imY,d.ICW]);const f=(0,i.ZP)(o.Z)((()=>({width:"100%",marginLeft:"170px",height:"93%",marginTop:"60px",padding:"16px",background:"#d0d0d0"}))),m=()=>{var e,a,t,i,o;const m=(0,n.I0)(),[p]=(0,l.useState)(0),{calendarData:v}=(0,n.v9)((e=>e.fileData)),[w,S]=(0,l.useState)((null===(e=v[p])||void 0===e||null===(a=e.children)||void 0===a?void 0:a.map((e=>[...e.children])).flat())||[]);(0,l.useEffect)((()=>{var e,a;S((null===(e=v[p])||void 0===e||null===(a=e.children)||void 0===a?void 0:a.map((e=>[...e.children])).flat())||[])}),[v]);const D=[{headerName:"Store",field:"storeLabel",pinned:"left",width:250},{headerName:"SKU",field:"skuLabel",pinned:"left",width:250},{headerName:null===(t=v[p])||void 0===t?void 0:t.headerName,children:null===(i=v[p])||void 0===i||null===(o=i.children)||void 0===o?void 0:o.map((e=>({headerName:e.headerName,children:[{headerName:"Sales Units",field:"SalesUnits",cellStyle:c.hD,width:130},{headerName:"Sales Dollars",field:"SalesDollar",valueFormatter:e=>"$".concat(e.value),cellStyle:c.hD,width:130},{headerName:"GM Dollars",field:"gmDollar",valueFormatter:e=>"$".concat(e.value),cellStyle:c.hD,width:130},{headerName:"GM Percent",field:"gmPercent",valueFormatter:e=>"".concat(e.value,"%"),cellStyle:c.hD,cellClassRules:c.e_,width:130}]})))}];return(0,u.jsx)(f,{children:(0,u.jsx)(r.s,{rowData:w,columnDefs:D,modules:[d.ICW],debug:!0,defaultColDef:c.KR,onGridReady:async()=>{try{const e=await fetch("https://res.cloudinary.com/dga7peviw/raw/upload/v1741378505/GSIV25_-_Sample_Data_bzxej5.xlsx"),a=await e.blob();if(!a)return;const t=new FileReader;t.readAsArrayBuffer(a),t.onload=e=>{var a;const t=null===(a=e.target)||void 0===a?void 0:a.result,l=s.ij(new Uint8Array(t),{type:"array"}),r=l.Sheets.Calendar,d=s.P6.sheet_to_json(r),i=l.Sheets.Planning,o=s.P6.sheet_to_json(i),n=l.Sheets.SKUs,c=s.P6.sheet_to_json(n),u={};c.forEach((e=>{let{ID:a,Label:t,Price:l,Cost:r}=e;u[a]={price:parseFloat(l),Label:t,cost:parseFloat(r)}}));const f=l.Sheets.Stores,p=s.P6.sheet_to_json(f),v={};p.forEach((e=>{let{ID:a,Label:t}=e;v[a]=t}));const w=[],S=[],D={};d.forEach((e=>{const{"Month Label":a,"Week Label":t,Week:l}=e;w.includes(a)||w.push(a),S.includes(l)||S.push(l),D[a]||(D[a]={headerName:a,children:[]});let r=D[a].children.find((e=>e.week===l));r||(r={headerName:t,week:l,children:[]},D[a].children.push(r))})),o.forEach((e=>{let{Store:a,SKU:t,Week:l,"Sales Units":r}=e;const d=u[t].price||0,i=u[t].cost||0,o=u[t].Label,s=v[a],n=d*r,h=n-r*i,c=Math.trunc(h/n*100)||0;Object.values(D).forEach((e=>{const d=e.children.find((e=>e.week===l));d&&d.children.push({Store:a,SKU:t,SalesUnits:r,SalesDollar:n.toFixed(2),skuLabel:o,storeLabel:s,gmDollar:h.toFixed(2),gmPercent:c})}))}));const b=w.map((e=>D[e])).filter(Boolean).map((e=>({...e,children:e.children.sort(((e,a)=>S.indexOf(e.week)-S.indexOf(a.week)))})));m((0,h.k2)(b))}}catch(e){console.error("Error fetching data:",e)}}})})}},5665:(e,a,t)=>{t.r(a),t.d(a,{default:()=>f});var l=t(2791),r=t(3614),d=t(9633),i=t(1565),o=t(4045),s=t(6029),n=t(4420),h=t(2643),c=(t(6704),t(164)),u=t(184);d.O3h.registerModules([d.I6w,d.oUh,d.CBb,d.ICW,d.n4K,d.wUi,d.yir,d.ZAx]);const f=()=>{const e=(0,n.I0)(),[a,t]=(0,l.useState)(null),{skuData:d}=(0,n.v9)((e=>e.fileData)),f=(0,l.useMemo)((()=>({width:"100%",height:"100%"})),[]),m=(0,l.useMemo)((()=>({height:"100%",width:"100%"})),[]),[p]=(0,l.useState)([{headerName:"",field:"delete",width:50,cellRenderer:c.DeleteButtonRenderer},{headerName:"SKU",field:"name",width:300,editable:!0},{headerName:"Price",field:"price",width:150,editable:!0},{headerName:"Cost",field:"cost",width:150,editable:!0}]),v={width:170,valueSetter:a=>{const t=a.data.ID,l=a.column.colId;if(null!==a&&void 0!==a&&a.newValue){const r=null===d||void 0===d?void 0:d.map((e=>e.ID===t?{...e,[l]:a.newValue}:e));e((0,h.JY)(r))}}},w=(0,l.useCallback)((async a=>{t(a.api);const l=await fetch("https://res.cloudinary.com/dga7peviw/raw/upload/v1741378505/GSIV25_-_Sample_Data_bzxej5.xlsx"),r=await l.blob();if(!r)return;const d=new FileReader;d.onload=a=>{var t;const l=null===(t=a.target)||void 0===t?void 0:t.result,r=o.ij(l,{type:"binary"}).Sheets.SKUs,d=o.P6.sheet_to_json(r).map((e=>({ID:e.ID,name:e.Label,price:e.Price,cost:e.Cost.toFixed(2)})));e((0,h.JY)(d))},d.readAsArrayBuffer(r)}),[]),S=(0,l.useCallback)((()=>{var t;if(!a)return;const l=null===a||void 0===a||null===(t=a.getRenderedNodes())||void 0===t?void 0:t.map(((e,a)=>({...e.data,seqNo:a+1})));e((0,h.JY)(l))}),[a,e]);return(0,u.jsx)(i.MainWrapper,{sx:{height:"85%"},children:(0,u.jsx)(s.Z,{style:f,children:(0,u.jsx)(s.Z,{style:m,children:(0,u.jsx)(r.s,{rowData:d,columnDefs:p,defaultColDef:v,rowDragManaged:!0,onGridReady:w,onDragStopped:S})})})})}},164:(e,a,t)=>{t.r(a),t.d(a,{DeleteButtonRenderer:()=>m,default:()=>p});var l=t(2791),r=t(3614),d=t(9633),i=t(1565),o=t(4045),s=t(3400),n=t(6029),h=t(1668),c=t(4420),u=t(2643),f=(t(6704),t(184));d.O3h.registerModules([d.I6w,d.oUh,d.CBb,d.ICW,d.n4K,d.ZAx]);const m=e=>{const{storeData:a}=(0,c.v9)((e=>e.fileData)),t=(0,c.I0)();return(0,f.jsx)(s.Z,{onClick:()=>{const l=a.filter((a=>a.ID!==e.data.ID)).map(((e,a)=>({...e,seqNo:a+1})));t((0,u.og)(l))},size:"small",children:(0,f.jsx)(h.Z,{})})},p=()=>{const e=(0,c.I0)(),{storeData:a}=(0,c.v9)((e=>e.fileData)),t=(0,l.useMemo)((()=>({width:"100%",height:"100%"})),[]),d=(0,l.useMemo)((()=>({height:"100%",width:"100%"})),[]),[s]=(0,l.useState)([{headerName:"",field:"delete",width:50,cellRenderer:m},{headerName:"S.No.",field:"seqNo",width:100,rowDrag:!0},{headerName:"Store ID",field:"ID",width:150,editable:!0},{headerName:"Store Name",field:"Label",width:250,editable:!0},{headerName:"City",field:"City",width:200,editable:!0},{headerName:"State",field:"State",width:100,editable:!0}]),h={width:170,valueSetter:t=>{const l=t.data.ID,r=t.column.colId;if(null!==t&&void 0!==t&&t.newValue){const d=null===a||void 0===a?void 0:a.map((e=>e.ID===l?{...e,[r]:t.newValue}:e));e((0,u.og)(d))}}},p=(0,l.useCallback)((async a=>{w(a.api);const t=await fetch("https://res.cloudinary.com/dga7peviw/raw/upload/v1741378505/GSIV25_-_Sample_Data_bzxej5.xlsx"),l=await t.blob();if(!l)return;const r=new FileReader;r.onload=a=>{var t;const l=null===(t=a.target)||void 0===t?void 0:t.result,r=o.ij(l,{type:"binary"}).Sheets.Stores,d=o.P6.sheet_to_json(r).map(((e,a)=>({seqNo:e["Seq No."]||a+1,ID:e.ID,Label:e.Label,City:e.City,State:e.State})));e((0,u.og)(d))},r.readAsArrayBuffer(l)}),[]),[v,w]=(0,l.useState)(null),S=(0,l.useCallback)((()=>{var a;if(!v)return;const t=null===v||void 0===v||null===(a=v.getRenderedNodes())||void 0===a?void 0:a.map(((e,a)=>({...e.data,seqNo:a+1})));e((0,u.og)(t))}),[v,e]);return(0,f.jsx)(i.MainWrapper,{sx:{height:"85%"},children:(0,f.jsx)(n.Z,{style:t,children:(0,f.jsx)(n.Z,{style:d,children:(0,f.jsx)(r.s,{rowData:a,columnDefs:s,defaultColDef:h,rowDragManaged:!0,onGridReady:p,onDragStopped:S})})})})}},1668:(e,a,t)=>{var l=t(4836);a.Z=void 0;var r=l(t(5649)),d=t(184),i=(0,r.default)((0,d.jsx)("path",{d:"M6 21h12V7H6v14zm2.46-9.12 1.41-1.41L12 12.59l2.12-2.12 1.41 1.41L13.41 14l2.12 2.12-1.41 1.41L12 15.41l-2.12 2.12-1.41-1.41L10.59 14l-2.13-2.12zM15.5 4l-1-1h-5l-1 1H5v2h14V4h-3.5z"}),"DeleteForeverSharp");a.Z=i},6704:()=>{}}]);
//# sourceMappingURL=665.e2316b75.chunk.js.map