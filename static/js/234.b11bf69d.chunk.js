"use strict";(self.webpackChunkmy_ts_app=self.webpackChunkmy_ts_app||[]).push([[234,565],{1565:(e,a,t)=>{t.r(a),t.d(a,{MainWrapper:()=>f,default:()=>p});var l=t(2791),r=t(3614),o=t(9633),n=t(6934),d=t(6029),s=t(4045),i=t(4420),c=t(2643),h=t(3763),u=t(184);o.O3h.registerModules([o.wUi,o.yir,o.imY,o.ICW]);const f=(0,n.ZP)(d.Z)((()=>({width:"100%",marginLeft:"170px",height:"93%",marginTop:"60px",padding:"16px",background:"#d0d0d0"}))),p=()=>{var e,a;const t=(0,i.I0)(),[n]=(0,l.useState)(0),[d,p]=(0,l.useState)(null),{calendarData:m,fileAdded:g}=(0,i.v9)((e=>e.fileData));(0,l.useEffect)((()=>{d&&S({api:d})}),[g,d]);const S=async e=>{p(e.api);try{const e=localStorage.getItem("file");let a;if(e){const t=JSON.parse(e),l=atob(t.split(",")[1]),r=new Array(l.length);for(let e=0;e<l.length;e++)r[e]=l.charCodeAt(e);const o=new Uint8Array(r);a=new Blob([o],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})}else{const e=await fetch(h.Ye);a=await e.blob()}if(!a)return;const l=new FileReader;l.readAsArrayBuffer(a),l.onload=e=>{var a;const l=null===(a=e.target)||void 0===a?void 0:a.result,r=s.ij(new Uint8Array(l),{type:"array"}),o=r.Sheets.Calendar,n=s.P6.sheet_to_json(o),d=r.Sheets.Planning,i=s.P6.sheet_to_json(d),h=r.Sheets.SKUs,u=s.P6.sheet_to_json(h),f={};u.forEach((e=>{let{ID:a,Label:t,Price:l,Cost:r}=e;f[a]={price:parseFloat(l),Label:t,cost:parseFloat(r)}}));const p=r.Sheets.Stores,m=s.P6.sheet_to_json(p),g={};m.forEach((e=>{let{ID:a,Label:t}=e;g[a]=t}));const S=[],v=[],b={};n.forEach((e=>{const{"Month Label":a,"Week Label":t,Week:l}=e;S.includes(a)||S.push(a),v.includes(l)||v.push(l),b[a]||(b[a]={headerName:a,children:[]});let r=b[a].children.find((e=>e.week===l));r||(r={headerName:t,week:l,children:[]},b[a].children.push(r))})),i.forEach((e=>{let{Store:a,SKU:t,Week:l,"Sales Units":r}=e;const o=f[t].price||0,n=f[t].cost||0,d=f[t].Label,s=g[a],i=o*r,c=i-r*n,h=Math.trunc(c/i*100)||0;Object.values(b).forEach((e=>{const o=e.children.find((e=>e.week===l));o&&o.children.push({Store:a,SKU:t,SalesUnits:r,SalesDollar:i.toFixed(2),skuLabel:d,storeLabel:s,gmDollar:c.toFixed(2),gmPercent:h})}))}));const w=S.map((e=>b[e])).filter(Boolean).map((e=>({...e,children:e.children.sort(((e,a)=>v.indexOf(e.week)-v.indexOf(a.week)))})));t((0,c.k2)(w))}}catch(a){console.error("Error fetching data:",a)}},[v,b]=(0,l.useState)((null===(e=m[n])||void 0===e||null===(a=e.children)||void 0===a?void 0:a.map((e=>[...e.children])).flat())||[]);(0,l.useEffect)((()=>{var e,a;b((null===(e=m[n])||void 0===e||null===(a=e.children)||void 0===a?void 0:a.map((e=>[...e.children])).flat())||[])}),[m]);const w=[{headerName:"Store",field:"storeLabel",pinned:"left",width:250},{headerName:"SKU",field:"skuLabel",pinned:"left",width:250},...(null!==m&&void 0!==m?m:[]).map((e=>{var a;return{headerName:e.headerName,children:(null!==(a=e.children)&&void 0!==a?a:[]).map((e=>({headerName:e.headerName,children:[{headerName:"Sales Units",field:"SalesUnits",cellStyle:h.hD,width:130},{headerName:"Sales Dollars",field:"SalesDollar",valueFormatter:e=>"$".concat(e.value),cellStyle:h.hD,width:130},{headerName:"GM Dollars",field:"gmDollar",valueFormatter:e=>"$".concat(e.value),cellStyle:h.hD,width:130},{headerName:"GM Percent",field:"gmPercent",valueFormatter:e=>"".concat(e.value,"%"),cellStyle:h.hD,cellClassRules:h.e_,width:130}]})))}}))];return(0,u.jsx)(f,{children:(0,u.jsx)(r.s,{rowData:v,columnDefs:w,modules:[o.ICW],debug:!0,defaultColDef:h.KR,onGridReady:S})})}},1234:(e,a,t)=>{t.r(a),t.d(a,{DeleteButtonRenderer:()=>y,default:()=>x});var l=t(2791),r=t(3614),o=t(9633),n=t(1565),d=t(4045),s=t(3400),i=t(6029),c=t(4294),h=t(1668),u=t(4420),f=t(2643),p=(t(6704),t(3763)),m=t(5289),g=t(7123),S=t(9157),v=t(5661),b=t(7665),w=t(184);function D(){const e=(0,u.I0)(),{addStoreDialog:a,storeData:t}=(0,u.v9)((e=>e.fileData)),[r,o]=(0,l.useState)(""),[n,d]=(0,l.useState)(""),[s,i]=(0,l.useState)(""),[h,p]=(0,l.useState)(""),[D,y]=(0,l.useState)(""),x=()=>{e((0,f.jp)(!1)),o(""),d(""),i(""),p(""),y("")};return(0,w.jsxs)(m.Z,{open:a,onClose:x,children:[(0,w.jsx)(v.Z,{children:"Add New Store"}),(0,w.jsxs)(S.Z,{children:[(0,w.jsx)(b.Z,{label:"Store",fullWidth:!0,margin:"dense",value:r,onChange:e=>o(e.target.value)}),(0,w.jsx)(b.Z,{label:"City",fullWidth:!0,margin:"dense",value:n,onChange:e=>d(e.target.value)}),(0,w.jsx)(b.Z,{label:"State",fullWidth:!0,margin:"dense",value:s,onChange:e=>i(e.target.value)}),(0,w.jsx)(b.Z,{label:"ID",fullWidth:!0,margin:"dense",value:h,onChange:e=>p(e.target.value),error:!!D,helperText:D})]}),(0,w.jsxs)(g.Z,{children:[(0,w.jsx)(c.Z,{onClick:x,sx:{background:"red",color:"#ffff","&:hover":{background:"red",opacity:.7}},children:"Cancel"}),(0,w.jsx)(c.Z,{onClick:()=>{r&&n&&s&&h?(e=>t.some((a=>a.ID===e)))(h)?y("ID already exists. Please use a unique ID."):(e((0,f.og)([...t,{seqNo:t.length+1,City:n,State:s,Label:r,ID:h}])),x()):y("All fields are required.")},sx:{background:"gray",color:"#ffff","&:hover":{background:"gray",opacity:.7}},disabled:!r||!n||!s||!h,children:"Add"})]})]})}o.O3h.registerModules([o.I6w,o.oUh,o.CBb,o.ICW,o.n4K,o.ZAx]);const y=e=>{const{storeData:a}=(0,u.v9)((e=>e.fileData)),t=(0,u.I0)();return(0,w.jsx)(s.Z,{onClick:()=>{const l=a.filter((a=>a.ID!==e.data.ID)).map(((e,a)=>({...e,seqNo:a+1})));t((0,f.og)(l))},size:"small",children:(0,w.jsx)(h.Z,{})})},x=()=>{const e=(0,u.I0)(),{storeData:a,fileAdded:t}=(0,u.v9)((e=>e.fileData)),[o,s]=(0,l.useState)(null),h=(0,l.useMemo)((()=>({width:"100%",height:"100%"})),[]),m=(0,l.useMemo)((()=>({height:"100%",width:"100%"})),[]),[g]=(0,l.useState)([{headerName:"",field:"delete",width:50,cellRenderer:y},{headerName:"S.No.",field:"seqNo",width:100,rowDrag:!0},{headerName:"Store ID",field:"ID",width:150,editable:!0},{headerName:"Store Name",field:"Label",width:250,editable:!0},{headerName:"City",field:"City",width:200,editable:!0},{headerName:"State",field:"State",width:100,editable:!0}]),S={width:170,valueSetter:t=>{const l=t.data.ID,r=t.column.colId;if(null!==t&&void 0!==t&&t.newValue){const o=null===a||void 0===a?void 0:a.map((e=>e.ID===l?{...e,[r]:t.newValue}:e));e((0,f.og)(o))}}};(0,l.useEffect)((()=>{o&&v({api:o})}),[t,o]);const v=(0,l.useCallback)((async a=>{s(a.api);const t=localStorage.getItem("file");let l;if(t){const e=JSON.parse(t),a=atob(e.split(",")[1]),r=new Array(a.length);for(let t=0;t<a.length;t++)r[t]=a.charCodeAt(t);const o=new Uint8Array(r);l=new Blob([o],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})}else{const e=await fetch(p.Ye);l=await e.blob()}if(!l)return;const r=new FileReader;r.onload=a=>{var t;const l=null===(t=a.target)||void 0===t?void 0:t.result,r=d.ij(l,{type:"binary"}).Sheets.Stores,o=d.P6.sheet_to_json(r).map(((e,a)=>({seqNo:e["Seq No."]||a+1,ID:e.ID,Label:e.Label,City:e.City,State:e.State})));e((0,f.og)(o))},r.readAsArrayBuffer(l)}),[t,e]),b=(0,l.useCallback)((()=>{var a;if(!o)return;const t=null===o||void 0===o||null===(a=o.getRenderedNodes())||void 0===a?void 0:a.map(((e,a)=>({...e.data,seqNo:a+1})));e((0,f.og)(t))}),[o,e]);return(0,w.jsxs)(n.MainWrapper,{sx:{height:"85%"},children:[(0,w.jsx)(i.Z,{style:h,children:(0,w.jsx)(i.Z,{style:m,children:(0,w.jsx)(r.s,{rowData:a,columnDefs:g,defaultColDef:S,rowDragManaged:!0,onGridReady:v,onDragStopped:b})})}),(0,w.jsx)(c.Z,{onClick:()=>e((0,f.jp)(!0)),sx:{mt:2,background:"gray",color:"#ffff",px:2,"&:hover":{background:"gray",opacity:.7}},children:"Add Store"}),(0,w.jsx)(D,{})]})}},6704:()=>{}}]);
//# sourceMappingURL=234.b11bf69d.chunk.js.map