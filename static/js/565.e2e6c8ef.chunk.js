"use strict";(self.webpackChunkmy_ts_app=self.webpackChunkmy_ts_app||[]).push([[565],{1565:(e,a,l)=>{l.r(a),l.d(a,{MainWrapper:()=>f,default:()=>p});var t=l(2791),r=l(3614),d=l(9633),n=l(6934),o=l(6029),s=l(4045),i=l(4420),c=l(2643),h=l(3763),u=l(184);d.O3h.registerModules([d.wUi,d.yir,d.imY,d.ICW]);const f=(0,n.ZP)(o.Z)((()=>({width:"100%",marginLeft:"170px",height:"93%",marginTop:"60px",padding:"16px",background:"#d0d0d0"}))),p=()=>{var e,a,l,n,o;const p=(0,i.I0)(),[m]=(0,t.useState)(0),{calendarData:v}=(0,i.v9)((e=>e.fileData)),[S,w]=(0,t.useState)((null===(e=v[m])||void 0===e||null===(a=e.children)||void 0===a?void 0:a.map((e=>[...e.children])).flat())||[]);(0,t.useEffect)((()=>{var e,a;w((null===(e=v[m])||void 0===e||null===(a=e.children)||void 0===a?void 0:a.map((e=>[...e.children])).flat())||[])}),[v]);const b=[{headerName:"Store",field:"storeLabel",pinned:"left",width:250},{headerName:"SKU",field:"skuLabel",pinned:"left",width:250},{headerName:null===(l=v[m])||void 0===l?void 0:l.headerName,children:null===(n=v[m])||void 0===n||null===(o=n.children)||void 0===o?void 0:o.map((e=>({headerName:e.headerName,children:[{headerName:"Sales Units",field:"SalesUnits",cellStyle:h.hD,width:130},{headerName:"Sales Dollars",field:"SalesDollar",valueFormatter:e=>"$".concat(e.value),cellStyle:h.hD,width:130},{headerName:"GM Dollars",field:"gmDollar",valueFormatter:e=>"$".concat(e.value),cellStyle:h.hD,width:130},{headerName:"GM Percent",field:"gmPercent",valueFormatter:e=>"".concat(e.value,"%"),cellStyle:h.hD,cellClassRules:h.e_,width:130}]})))}];return(0,u.jsx)(f,{children:(0,u.jsx)(r.s,{rowData:S,columnDefs:b,modules:[d.ICW],debug:!0,defaultColDef:h.KR,onGridReady:async()=>{try{const e=await fetch("https://res.cloudinary.com/dga7peviw/raw/upload/v1741378505/GSIV25_-_Sample_Data_bzxej5.xlsx"),a=await e.blob();if(!a)return;const l=new FileReader;l.readAsArrayBuffer(a),l.onload=e=>{var a;const l=null===(a=e.target)||void 0===a?void 0:a.result,t=s.ij(new Uint8Array(l),{type:"array"}),r=t.Sheets.Calendar,d=s.P6.sheet_to_json(r),n=t.Sheets.Planning,o=s.P6.sheet_to_json(n),i=t.Sheets.SKUs,h=s.P6.sheet_to_json(i),u={};h.forEach((e=>{let{ID:a,Label:l,Price:t,Cost:r}=e;u[a]={price:parseFloat(t),Label:l,cost:parseFloat(r)}}));const f=t.Sheets.Stores,m=s.P6.sheet_to_json(f),v={};m.forEach((e=>{let{ID:a,Label:l}=e;v[a]=l}));const S=[],w=[],b={};d.forEach((e=>{const{"Month Label":a,"Week Label":l,Week:t}=e;S.includes(a)||S.push(a),w.includes(t)||w.push(t),b[a]||(b[a]={headerName:a,children:[]});let r=b[a].children.find((e=>e.week===t));r||(r={headerName:l,week:t,children:[]},b[a].children.push(r))})),o.forEach((e=>{let{Store:a,SKU:l,Week:t,"Sales Units":r}=e;const d=u[l].price||0,n=u[l].cost||0,o=u[l].Label,s=v[a],i=d*r,c=i-r*n,h=Math.trunc(c/i*100)||0;Object.values(b).forEach((e=>{const d=e.children.find((e=>e.week===t));d&&d.children.push({Store:a,SKU:l,SalesUnits:r,SalesDollar:i.toFixed(2),skuLabel:o,storeLabel:s,gmDollar:c.toFixed(2),gmPercent:h})}))}));const D=S.map((e=>b[e])).filter(Boolean).map((e=>({...e,children:e.children.sort(((e,a)=>w.indexOf(e.week)-w.indexOf(a.week)))})));p((0,c.k2)(D))}}catch(e){console.error("Error fetching data:",e)}}})})}}}]);
//# sourceMappingURL=565.e2e6c8ef.chunk.js.map